<html>
<head>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
    <script src="http://guide.withabout.net/guide/gp332/459916/Chart.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
    <script src="https://d3js.org/d3.v5.min.js"></script>

    <script type='text/javascript' src='https://raw.githubusercontent.com/kimmobrunfeldt/progressbar.js/master/dist/progressbar.js'></script>
    <meta charset="utf-8">
    <!-- どのデバイスで見ても見え方を一緒にする = レスポンシブデザイン -->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<style>

label {
    padding: 10px 40px;
    color: #ffffff;
    background-color: #dd287d;
    cursor: pointer;
    border-top-left-radius: 20px;
    border-top-right-radius: 20px;
    border-bottom-right-radius: 20px;
    border-bottom-left-radius: 20px;
}

input[type="file"] {
    display: none;
}

.box2 {
    padding: 0.5em 1em;
    margin: 2em 0;
    font-weight: bold;
    color: #6091d3;/*文字色*/
    background: #FFF;
    border: solid 3px #00050a;/*線*/
    border-radius: 10px;/*角の丸み*/
}

.box2 p {
    margin: 0; 
    padding: 0;
}

.circle {
      border-radius: 50%;
      width: 120px;
      height: 120px;
    }

h4 {
  /*線の種類（実線） 太さ 色*/
  border-bottom: solid 3px black;
}

#chart--wrapper {
            max-width: 100%;
            position: relative;
            margin: 0 auto;
            padding-top: 40%;
            min-height: 300px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            -webkit-font-kerning: normal;
            font-kerning: normal;
            font-family: "Helvetica Neue","Roboto","ヒラギノ角ゴ ProN", "Hiragino Kaku Gothic ProN","游ゴシック体","Yu Gothic", YuGothic, Verdana, Meiryo, sans-serif !important;
        }
        
        #chart--wrapper svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        .axis .domain{
            stroke: #ccc;
            position: relative;
        }
        .axis .tick line{
            stroke: #ccc;
        }
        
        .axis .tick text{
            fill: #223F4B;
            font-family: "Helvetica Neue","Roboto","ヒラギノ角ゴ ProN", "Hiragino Kaku Gothic ProN","游ゴシック体","Yu Gothic", YuGothic, Verdana, Meiryo, sans-serif !important;
            font-size: 0.7rem;
        }

        .liquidFillGaugeText { font-family: Helvetica; font-weight: bold; }

        #container {
  margin: 20px;
  width: 400px;
  height: 8px;
  position: relative;
}
b.example1 { font-size: xx-large; }
</style>
</head>
<body>
<main>
<div class="px-4 py-5 my-5 text-center">
<div class="jumbotron">
<h1>Simple LINE Analysis</h1>
</div>
<h4>◯◯さんとの相性記録</h4>
<!--アイコン-->
<!--アイコン画像を入れる-->
<img src="https://pics.prcm.jp/076c713d5c98f/74750340/jpeg/74750340.jpeg" class="circle">
<br>
<br>
<h4>最新のスコア</h4>
<div class="box2">
    <p>最新のスコアが表示されます
    </p>
</div>
<div class="card">
    <div class="card-body">
      <h3 class="card-title">最新スコア</h3>
      <br>
      <b><center>65点</center></b>
      <div class="progress" style="height: 50px;">
        <div class="progress-bar bg-success" role="progressbar" style="width: 65%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">65点</div>
      </div>
    </div>
<script>
// progressbar.js@1.0.0 version is used
// Docs: http://progressbarjs.readthedocs.org/en/1.0.0/

var bar = new ProgressBar.Line(container, {
  strokeWidth: 4,
  easing: 'easeInOut',
  duration: 1400,
  color: '#FFEA82',
  trailColor: '#eee',
  trailWidth: 1,
  svgStyle: {width: '100%', height: '100%'}
});

bar.animate(1.0);  // Number from 0.0 to 1.0
    </script>
<div id="container">
</div>
<br>
<h4>各表現ランク</h4>
<div class="row">
  <div class="col-sm-6">
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">愛情表現</h5>
        <img src="https://img14.shop-pro.jp/PA01303/605/product/86739873.png?cmsp_timestamp=20190601203731" class="circle">
        <b class="example1">A</b>
      </div>
    </div>
  </div>
  <div class="col-sm-6">
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">賞賛表現</h5>
        <img src="https://cdn.emojidex.com/emoji/seal/reversed_thumbs_up_sign.png?1417135362" class="circle">
        <b class="example1">A</b>
      </div>
    </div>
  </div>
</div>
<br>
<div class="row">
  <div class="col-sm-6">
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">謝罪表現</h5>
        <img src="https://2.bp.blogspot.com/-HUTXJXs7Va4/WZVg1CzrH8I/AAAAAAABGFM/ebgsMcAigKIg69dW2U7GFIPJ91z116ZsACLcBGAs/s800/dogeza_businessman.png" class="circle">
        <b class="example1">A</b>
      </div>
    </div>
  </div>
  <div class="col-sm-6">
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">感謝表現</h5>
        <img src="https://emojigraph.org/media/emojipedia/smiling-face-with-tear_1f972.png" class="circle">
        <b class="example1">A</b>
      </div>
    </div>
  </div>
</div>
<h4>相性推移</h4>
<div class="box2">
    <p>相性の推移が入ります
    </p>
    </div>
    <div class="container py-4">
        <div id="chart--wrapper"></div>
    </div>
<!--グラフを入れる-->
<br>
<h4>アクション</h4>
<div class="box2">
<p>具体的なアクション数が入ります</p>
</div>
<script>
    const contents = d3.select('#chart--wrapper');
    const svg = contents.append("svg");
    const padding = 30;
    let color = d3.rgb("#85a7cc");


    let dataset = [
        {
            date : "2019/1/1",
            value : 70
        },
        {
            date : "2019/2/1",
            value : 65.1
        },
        {
            date : "2019/3/1",
            value : 81.6
        },
        {
            date : "2019/4/1",
            value : 55.3
        },
        {
            date : "2019/5/1",
            value : 30.6
        },
        {
            date : "2019/6/1",
            value : 55.4
        },
        {
            date : "2019/7/1",
            value : 72.9
        },
        {
            date : "2019/8/1",
            value : 82.2
        },
        {
            date : "2019/9/1",
            value : 66.4
        },
        {
            date : "2019/10/1",
            value : 73.3
        },
        {
            date : "2019/11/1",
            value : 25.4
        },
        {
            date : "2019/12/1",
            value : 57.4
        }
    ];
    let x,y,xScale,yScale,width,height,line,path,area,lineArea,linearGradient;
    
    let timeparser = d3.timeParse("%Y/%m/%d");
    // x軸の目盛りの表示フォーマット
    let format = d3.timeFormat("%Y/%m");
    
    const lineChart = {
        initialize : function(){
            dataset = dataset.map(function(d){
                // 日付のデータをパース
                return  { date: timeparser(d.date), value:d.value } ;
            });
            // レンダリング
            this.rendar();
            // アップデート
            this.update();
            // アニメーション
            this.animate();

            // リサイズ時の処理
            this.resize();
        },
        rendar : function(){
            
            // パス要素を追加
            path = svg.append("path");

            lineArea = svg.append("path")
    
            g = svg.append("g");

            linearGradient = svg.append("defs")
            .append("linearGradient")
            .attr("id", "linear-gradient")
            .attr("gradientTransform", "rotate(90)");

            linearGradient.append("stop")
                .attr("offset", "0%")
                .attr("stop-color",color.brighter(1.5));

            linearGradient.append("stop")
                .attr("offset", "100%")
                .attr("stop-color","rgba(255,255,255,0)");

            // svg要素にg要素を追加しクラスを付与しxに代入
            x = svg.append("g")
            .attr("class", "axis axis-x");

            // svg要素にg要素を追加しクラスを付与しyに代入
            y = svg.append("g")
            .attr("class", "axis axis-y");
        },
        update : function () {
            // グラフの幅
            width = contents.node().clientWidth - padding;
            // グラフの高さ
            height = contents.node().clientHeight - padding;
            // X軸Y軸を追加
            this.addScales();
            // エリアを追加
            this.addArea();
            // ラインを追加
            this.addLine();
        },
        resize:function(){
            let self = this;
            window.addEventListener("resize",function () {
                // アップデート
                self.update();
            })
        },
        addScales : function(){

            // x軸の目盛りの量
            let xTicks = (window.innerWidth < 768) ? 6: 12;
            // X軸を時間のスケールに設定する
            xScale = d3.scaleTime()
            // 最小値と最大値を指定しX軸の領域を設定する
            .domain([
                // データ内の日付の最小値を取得
                d3.min(dataset, function(d){return d.date;}),
                // データ内の日付の最大値を取得
                d3.max(dataset, function(d){return d.date;})
            ])
            // SVG内でのX軸の位置の開始位置と終了位置を指定しX軸の幅を設定する
            .range([padding, width]);


            // Y軸を値のスケールに設定する
            yScale = d3.scaleLinear()
            // 最小値と最大値を指定しX軸の領域を設定する
            .domain([
                // 0を最小値として設定
                0,
                // データ内のvalueの最大値を取得
                d3.max(dataset, function(d){return d.value;})
            ])
            // SVG内でのY軸の位置の開始位置と終了位置を指定しY軸の幅を設定する
            .range([height, padding]);

            // scaleをセットしてX軸を作成
            axisx = d3.axisBottom(xScale)
            // グラフの目盛りの数を設定
            .ticks(xTicks)
            // 目盛りの表示フォーマットを設定
            .tickFormat(format);

            // scaleをセットしてY軸を作成
            axisy = d3.axisLeft(yScale);

            // X軸の位置を指定し軸をセット
            x.attr("transform", "translate(" + 0 + "," + (height) + ")")  
            .call(axisx); 
        
            // Y軸の位置を指定し軸をセット
            y.attr("transform", "translate(" + padding + "," + 0 + ")")
            .call(axisy)
        },
        addLine :function(){

            //lineを生成
            line = d3.line()
            // lineのX軸をセット
            .x(function(d) { return xScale(d.date); })
            // lineのY軸をセット
            .y(function(d) { return yScale(d.value); })
            // カーブを設定
            .curve(d3.curveCatmullRom.alpha(0.4))
            
            path
            // dataをセット
            .datum(dataset)
            // 塗りつぶしをなしに
            .attr("fill", "none")
            // strokeカラーを設定
            .attr("stroke", color)
            // strokeカラーを設定
            .attr("stroke-width", 2)

            .attr("stroke-dashoffset", 0)
            .attr("stroke-dasharray", 0)
            // d属性を設定
            .attr("d", line)
        },
        addArea : function(){
            
            area = d3.area()
            .x(function(d) { return xScale(d.date); })
            .y1(function(d) { return yScale(d.value); })
            .y0(yScale(0))
            // カーブを設定
            .curve(d3.curveCatmullRom.alpha(0.4))

            lineArea
            .datum(dataset)
            .attr("d",area)
            .style("fill", "url(#linear-gradient)")
        },
        animate:function(){
            
            let totalLength = path.node().getTotalLength();

            path
            .attr("stroke-dasharray", totalLength + " " + totalLength)
            .attr("stroke-dashoffset", totalLength)
            .transition()
            .duration(1000)
            .ease(d3.easeCircleInOut)
            .attr("stroke-dashoffset", 0);

            lineArea.style("opacity",0)
            .transition()
            .delay(500)
            .duration(300)
            .ease(d3.easeCircleOut)
            .style("opacity",1);
        }
    };

    lineChart.initialize();
</script>
<div class="row">
    <div class="col-sm-6">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">emoji使用</h5>
          <h6 class="card-title">あなた</h6>
          <div class="progress">
              <div class="progress-bar bg-success" role="progressbar" style="width: 65%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">65点</div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-sm-6">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">emoji使用</h5>
          <h6 class="card-title">あなた</h6>
          <div class="progress">
              <div class="progress-bar bg-success" role="progressbar" style="width: 65%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">65点</div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-sm-6">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">emoji使用</h5>
          <h6 class="card-title">あなた</h6>
          <div class="progress">
              <div class="progress-bar bg-success" role="progressbar" style="width: 65%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">65点</div>
          </div>
        </div>
      </div>
    </div>
      <div class="col-sm-6">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title">emoji使用</h5>
            <h6 class="card-title">あなた</h6>
            <div class="progress">
                <div class="progress-bar bg-success" role="progressbar" style="width: 65%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">65点</div>
            </div>
          </div>
        </div>
      </div>
  </div>
  <div class="row">
    <div class="col-sm-6">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">emoji使用</h5>
          <h6 class="card-title">あなた</h6>
          <div class="progress">
              <div class="progress-bar bg-success" role="progressbar" style="width: 65%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">65点</div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-sm-6">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">emoji使用</h5>
          <h6 class="card-title">あなた</h6>
          <div class="progress">
              <div class="progress-bar bg-success" role="progressbar" style="width: 65%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">65点</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<br>
<h4>会話の内容</h4>

<div class="box2">
<p>会話中よく出てくる単語</p>
</div>
<div class="table-responsive">
  <table class="table table-striped table-sm">
    <thead>
      <tr>
        <th scope="col">順位</th>
        <th scope="col">単語</th>
        <th scope="col">回数</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>1</td>
        <td>あお</td>
        <td>3</td>
      </tr>
      <tr>
        <td>2</td>
        <td>いね</td>
        <td>2</td>
      </tr>
      <tr>
        <td>3</td>
        <td>うた</td>
        <td>1</td>
      </tr>
    </tbody>
  </table>
</div>
</div>
</main>
</body>
</html>